<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æœã®å¤©æ°— â€“ åŠ æ›½åˆ©ç”º</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Kaisei+Decol:wght@400;700&family=Zen+Maru+Gothic:wght@400;700&display=swap');

  :root {
    --sky-morning: #ffd89b;
    --sky-top: #ffb347;
    --cloud: #fff9f0;
    --text-dark: #3a2a1a;
    --text-mid: #6b4c2a;
    --accent: #ff7c43;
    --btn: #ff6b35;
    --btn-hover: #e85d2c;
    --card-bg: rgba(255,255,255,0.72);
    --shadow: 0 8px 40px rgba(200,120,50,0.18);
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    min-height: 100vh;
    background: linear-gradient(170deg, #ffe0a0 0%, #ffb347 40%, #ff8c42 75%, #e8663a 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-family: 'Zen Maru Gothic', sans-serif;
    overflow: hidden;
    position: relative;
  }

  /* èƒŒæ™¯é›² */
  .cloud-bg {
    position: fixed;
    border-radius: 50%;
    background: rgba(255,255,255,0.15);
    filter: blur(40px);
    pointer-events: none;
  }
  .c1 { width: 420px; height: 160px; top: 5%; left: -80px; }
  .c2 { width: 300px; height: 120px; top: 12%; right: 40px; }
  .c3 { width: 500px; height: 140px; bottom: 15%; left: -60px; }

  /* ãƒ¡ã‚¤ãƒ³ã‚«ãƒ¼ãƒ‰ */
  .card {
    background: var(--card-bg);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: 32px;
    padding: 40px 48px 44px;
    max-width: 480px;
    width: 92vw;
    box-shadow: var(--shadow), inset 0 1px 0 rgba(255,255,255,0.8);
    border: 1.5px solid rgba(255,255,255,0.5);
    text-align: center;
    position: relative;
    z-index: 10;
  }

  .location {
    font-family: 'Kaisei Decol', serif;
    font-size: 1rem;
    color: var(--text-mid);
    letter-spacing: 0.12em;
    margin-bottom: 4px;
  }

  .date-display {
    font-family: 'Kaisei Decol', serif;
    font-size: 1.7rem;
    color: var(--text-dark);
    font-weight: 700;
    margin-bottom: 28px;
  }

  /* å¤©æ°—ã‚¤ãƒ©ã‚¹ãƒˆ */
  .weather-art {
    font-size: 120px;
    line-height: 1;
    margin: 0 auto 16px;
    filter: drop-shadow(0 6px 18px rgba(200,100,30,0.25));
    animation: floatArt 4s ease-in-out infinite;
    display: block;
    transition: transform 0.3s;
  }
  @keyframes floatArt {
    0%,100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  .weather-label {
    font-family: 'Kaisei Decol', serif;
    font-size: 2rem;
    font-weight: 700;
    color: var(--text-dark);
    margin-bottom: 4px;
  }

  .weather-desc {
    font-size: 0.95rem;
    color: var(--text-mid);
    min-height: 2.2rem;
    line-height: 1.6;
    margin-bottom: 22px;
  }

  /* æ°—æ¸©ãƒ»æ¹¿åº¦ */
  .stats {
    display: flex;
    gap: 16px;
    justify-content: center;
    margin-bottom: 30px;
    flex-wrap: wrap;
  }
  .stat {
    background: rgba(255,180,80,0.2);
    border-radius: 16px;
    padding: 12px 22px;
    min-width: 110px;
  }
  .stat-label {
    font-size: 0.75rem;
    color: var(--text-mid);
    margin-bottom: 3px;
  }
  .stat-value {
    font-family: 'Kaisei Decol', serif;
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-dark);
  }

  /* ãƒœã‚¿ãƒ³ */
  .btn {
    background: linear-gradient(135deg, var(--btn), #ff9a3c);
    color: #fff;
    border: none;
    border-radius: 999px;
    padding: 18px 44px;
    font-family: 'Zen Maru Gothic', sans-serif;
    font-size: 1.15rem;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 6px 24px rgba(255,107,53,0.45);
    transition: transform 0.15s, box-shadow 0.15s, background 0.2s;
    letter-spacing: 0.08em;
    position: relative;
    overflow: hidden;
  }
  .btn:hover {
    background: linear-gradient(135deg, var(--btn-hover), #ff7e20);
    transform: translateY(-2px);
    box-shadow: 0 10px 32px rgba(255,107,53,0.55);
  }
  .btn:active { transform: translateY(0); }
  .btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

  /* ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° */
  .loading {
    display: none;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    margin-bottom: 20px;
  }
  .spinner {
    width: 48px; height: 48px;
    border: 5px solid rgba(255,150,50,0.25);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.9s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  .weather-content { display: none; }

  .error-msg {
    display: none;
    color: #c0392b;
    font-size: 0.9rem;
    margin-bottom: 12px;
    padding: 10px 16px;
    background: rgba(255,100,100,0.12);
    border-radius: 12px;
  }

  /* éŸ³å£°ãƒœã‚¿ãƒ³ */
  .speak-btn {
    background: none;
    border: 2px solid var(--accent);
    color: var(--accent);
    border-radius: 999px;
    padding: 10px 28px;
    font-family: 'Zen Maru Gothic', sans-serif;
    font-size: 0.95rem;
    cursor: pointer;
    margin-top: 12px;
    transition: background 0.2s, color 0.2s;
    display: none;
  }
  .speak-btn:hover { background: var(--accent); color: #fff; }

  footer {
    margin-top: 20px;
    font-size: 0.72rem;
    color: rgba(255,255,255,0.65);
    z-index: 10;
  }
</style>
</head>
<body>

<div class="cloud-bg c1"></div>
<div class="cloud-bg c2"></div>
<div class="cloud-bg c3"></div>

<div class="card">
  <div class="location">ğŸ“ åƒè‘‰å¸‚è‹¥è‘‰åŒº åŠ æ›½åˆ©ç”º</div>
  <div class="date-display" id="dateDisplay">â€”</div>

  <div class="loading" id="loading">
    <div class="spinner"></div>
    <div style="color:var(--text-mid);font-size:0.9rem;">ãŠå¤©æ°—ã‚’èª¿ã¹ã¦ã„ã¾ã™â€¦</div>
  </div>

  <div class="error-msg" id="errorMsg"></div>

  <div class="weather-content" id="weatherContent">
    <div class="weather-art" id="weatherArt">â˜€ï¸</div>
    <div class="weather-label" id="weatherLabel">â€”</div>
    <div class="weather-desc" id="weatherDesc"></div>
    <div class="stats">
      <div class="stat">
        <div class="stat-label">ğŸŒ¡ æœ€é«˜æ°—æ¸©</div>
        <div class="stat-value" id="tempMax">â€”</div>
      </div>
      <div class="stat">
        <div class="stat-label">ğŸŒ¡ æœ€ä½æ°—æ¸©</div>
        <div class="stat-value" id="tempMin">â€”</div>
      </div>
      <div class="stat">
        <div class="stat-label">ğŸ’§ é™æ°´ç¢ºç‡</div>
        <div class="stat-value" id="precip">â€”</div>
      </div>
      <div class="stat">
        <div class="stat-label">ğŸ’¨ é¢¨é€Ÿ</div>
        <div class="stat-value" id="wind">â€”</div>
      </div>
    </div>
    <button class="speak-btn" id="speakBtn" onclick="speakWeather()">ğŸ”Š ã‚‚ã†ä¸€åº¦èã</button>
  </div>

  <button class="btn" id="fetchBtn" onclick="fetchWeather()">ğŸŒ¤ ä»Šæ—¥ã®ãŠå¤©æ°—ã‚’èª¿ã¹ã‚‹</button>
</div>

<footer>ãƒ‡ãƒ¼ã‚¿æä¾›: Open-Meteo (ç„¡æ–™) &nbsp;|&nbsp; ã‚³ã‚¹ãƒˆ Â¥0</footer>

<script>
  // ä»Šæ—¥ã®æ—¥ä»˜è¡¨ç¤º
  const today = new Date();
  const weekDays = ['æ—¥','æœˆ','ç«','æ°´','æœ¨','é‡‘','åœŸ'];
  document.getElementById('dateDisplay').textContent =
    `${today.getMonth()+1}æœˆ${today.getDate()}æ—¥ï¼ˆ${weekDays[today.getDay()]}ï¼‰`;

  // WMOå¤©æ°—ã‚³ãƒ¼ãƒ‰ â†’ æ—¥æœ¬èªãƒ»çµµæ–‡å­—
  function getWeatherInfo(code) {
    const map = {
      0:  { emoji:'â˜€ï¸',  label:'å¿«æ™´',     desc:'é›²ã²ã¨ã¤ãªã„é’ç©ºã§ã™ã€‚æ—¥å·®ã—ãŒå¼·ããªã‚Šãã†ã§ã™ã­ï¼'},
      1:  { emoji:'ğŸŒ¤ï¸',  label:'ã»ã¼æ™´ã‚Œ', desc:'ã»ã¨ã‚“ã©æ™´ã‚Œã¦ã„ã¾ã™ã€‚æ°—æŒã¡ã®ã„ã„ä¸€æ—¥ã«ãªã‚Šãã†ã§ã™ã€‚'},
      2:  { emoji:'â›…',  label:'æ™´ã‚Œæ™‚ã€…æ›‡ã‚Š', desc:'æ™´ã‚Œã¨æ›‡ã‚ŠãŒäº¤äº’ã«ã‚„ã£ã¦ãã¾ã™ã€‚ä¸Šç€ãŒã‚ã‚‹ã¨å®‰å¿ƒã‹ã‚‚ã€‚'},
      3:  { emoji:'â˜ï¸',  label:'æ›‡ã‚Š',     desc:'é›²ãŒç©ºã‚’è¦†ã£ã¦ã„ã¾ã™ã€‚å°‘ã—è‚Œå¯’ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚'},
      45: { emoji:'ğŸŒ«ï¸',  label:'éœ§',       desc:'éœ§ãŒå‡ºã¦ã„ã¾ã™ã€‚è¦‹é€šã—ã«æ³¨æ„ã—ã¦å¤–å‡ºã—ã¾ã—ã‚‡ã†ã€‚'},
      48: { emoji:'ğŸŒ«ï¸',  label:'éœ§æ°·',     desc:'éœ§æ°·ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚è¶³å…ƒã«æ°—ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚'},
      51: { emoji:'ğŸŒ¦ï¸',  label:'éœ§é›¨ï¼ˆå¼±ï¼‰', desc:'ç´°ã‹ã„éœ§é›¨ãŒé™ã£ã¦ã„ã¾ã™ã€‚æŠ˜ã‚Šç•³ã¿å‚˜ãŒã‚ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚'},
      53: { emoji:'ğŸŒ¦ï¸',  label:'éœ§é›¨',     desc:'éœ§é›¨ãŒé™ã£ã¦ã„ã¾ã™ã€‚å‚˜ã‚’æŒã£ã¦ã§ã‹ã‘ã¾ã—ã‚‡ã†ã€‚'},
      55: { emoji:'ğŸŒ§ï¸',  label:'éœ§é›¨ï¼ˆå¼·ï¼‰', desc:'ã‚„ã‚„å¼·ã„éœ§é›¨ã§ã™ã€‚ã—ã£ã‹ã‚Šã—ãŸå‚˜ã‚’ç”¨æ„ã—ã¾ã—ã‚‡ã†ã€‚'},
      61: { emoji:'ğŸŒ§ï¸',  label:'å°é›¨',     desc:'å°é›¨ãŒé™ã£ã¦ã„ã¾ã™ã€‚å‚˜ã‚’ãŠå¿˜ã‚Œãªãï¼'},
      63: { emoji:'ğŸŒ§ï¸',  label:'é›¨',       desc:'é›¨ãŒé™ã£ã¦ã„ã¾ã™ã€‚ã—ã£ã‹ã‚Šé›¨å…·ã‚’æº–å‚™ã—ã¦ãã ã•ã„ã€‚'},
      65: { emoji:'ğŸŒ§ï¸',  label:'å¤§é›¨',     desc:'å¼·ã„é›¨ãŒé™ã£ã¦ã„ã¾ã™ã€‚å¤–å‡ºæ™‚ã¯ååˆ†ã«æ°—ã‚’ä»˜ã‘ã¾ã—ã‚‡ã†ã€‚'},
      71: { emoji:'ğŸŒ¨ï¸',  label:'å°é›ª',     desc:'å°é›ªãŒé™ã£ã¦ã„ã¾ã™ã€‚è·¯é¢ãŒæ»‘ã‚Šã‚„ã™ããªã‚‹ã‹ã‚‚ã€‚'},
      73: { emoji:'â„ï¸',  label:'é›ª',       desc:'é›ªãŒé™ã£ã¦ã„ã¾ã™ã€‚é˜²å¯’ã¨è¶³å…ƒã«æ°—ã‚’ä»˜ã‘ã¦ãã ã•ã„ã€‚'},
      75: { emoji:'â„ï¸',  label:'å¤§é›ª',     desc:'å¤§é›ªã§ã™ï¼äº¤é€šæƒ…å ±ã‚’ç¢ºèªã—ã¦ã‹ã‚‰å¤–å‡ºã—ã¾ã—ã‚‡ã†ã€‚'},
      77: { emoji:'ğŸŒ¨ï¸',  label:'éœ§é›ª',     desc:'éœ§é›ªãŒé™ã£ã¦ã„ã¾ã™ã€‚æ»‘ã‚Šã‚„ã™ã„ã®ã§æ³¨æ„ã—ã¾ã—ã‚‡ã†ã€‚'},
      80: { emoji:'ğŸŒ¦ï¸',  label:'ã«ã‚ã‹é›¨ï¼ˆå¼±ï¼‰', desc:'ã«ã‚ã‹é›¨ãŒé™ã£ã¦ã„ã¾ã™ã€‚æŠ˜ã‚Šç•³ã¿å‚˜ãŒã‚ã‚‹ã¨å®‰å¿ƒã§ã™ã€‚'},
      81: { emoji:'ğŸŒ¦ï¸',  label:'ã«ã‚ã‹é›¨', desc:'ã«ã‚ã‹é›¨ãŒé™ã£ã¦ã„ã¾ã™ã€‚å‚˜ã®æº–å‚™ã‚’å¿˜ã‚Œãšã«ï¼'},
      82: { emoji:'â›ˆï¸',  label:'æ¿€ã—ã„ã«ã‚ã‹é›¨', desc:'æ¿€ã—ã„ã«ã‚ã‹é›¨ã§ã™ã€‚ã§ãã‚‹ã ã‘å±‹å†…ã§éã”ã—ã¾ã—ã‚‡ã†ã€‚'},
      85: { emoji:'ğŸŒ¨ï¸',  label:'ã«ã‚ã‹é›ª', desc:'ã«ã‚ã‹é›ªãŒé™ã£ã¦ã„ã¾ã™ã€‚è·¯é¢ã«æ³¨æ„ã—ã¦ãã ã•ã„ã€‚'},
      86: { emoji:'ğŸŒ¨ï¸',  label:'æ¿€ã—ã„ã«ã‚ã‹é›ª', desc:'æ¿€ã—ã„ã«ã‚ã‹é›ªã§ã™ã€‚å¤–å‡ºã‚’æ§ãˆã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚'},
      95: { emoji:'â›ˆï¸',  label:'é›·é›¨',     desc:'é›·é›¨ãŒç™ºç”Ÿã—ã¦ã„ã¾ã™ã€‚é«˜ã„å ´æ‰€ã‚„æœ¨ã®ä¸‹ã¯é¿ã‘ã¦ãã ã•ã„ã€‚'},
      96: { emoji:'â›ˆï¸',  label:'é›·é›¨ï¼ˆé›¹ã‚ã‚Šï¼‰', desc:'é›¹ã‚’ä¼´ã†é›·é›¨ã§ã™ã€‚å±‹å†…ã§ãŠéã”ã—ãã ã•ã„ã€‚'},
      99: { emoji:'â›ˆï¸',  label:'æ¿€ã—ã„é›·é›¨', desc:'æ¿€ã—ã„é›·é›¨ã§ã™ã€‚çµ¶å¯¾ã«å¤–å‡ºã‚’æ§ãˆã¦ãã ã•ã„ã€‚'},
    };
    return map[code] || { emoji:'ğŸŒˆ', label:'ä¸æ˜', desc:'å¤©æ°—æƒ…å ±ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚' };
  }

  let currentSpeechText = '';

  function speakWeather() {
    if (!currentSpeechText) return;
    window.speechSynthesis.cancel();
    const utter = new SpeechSynthesisUtterance(currentSpeechText);
    utter.lang = 'ja-JP';
    utter.rate = 0.95;
    utter.pitch = 1.1;
    window.speechSynthesis.speak(utter);
  }

  async function fetchWeather() {
    const btn = document.getElementById('fetchBtn');
    const loading = document.getElementById('loading');
    const content = document.getElementById('weatherContent');
    const errorMsg = document.getElementById('errorMsg');
    const speakBtn = document.getElementById('speakBtn');

    btn.disabled = true;
    errorMsg.style.display = 'none';
    content.style.display = 'none';
    speakBtn.style.display = 'none';
    loading.style.display = 'flex';

    try {
      // Open-Meteo API (å®Œå…¨ç„¡æ–™ãƒ»APIã‚­ãƒ¼ä¸è¦)
      const lat = 35.6285;
      const lon = 140.1512;
      const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=weathercode,temperature_2m_max,temperature_2m_min,precipitation_probability_max,windspeed_10m_max&timezone=Asia%2FTokyo&forecast_days=1`;

      const res = await fetch(url);
      if (!res.ok) throw new Error('ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼');
      const data = await res.json();

      const d = data.daily;
      const code = d.weathercode[0];
      const tMax = Math.round(d.temperature_2m_max[0]);
      const tMin = Math.round(d.temperature_2m_min[0]);
      const precip = d.precipitation_probability_max[0];
      const windspeed = Math.round(d.windspeed_10m_max[0]);

      const info = getWeatherInfo(code);

      document.getElementById('weatherArt').textContent = info.emoji;
      document.getElementById('weatherLabel').textContent = info.label;
      document.getElementById('weatherDesc').textContent = info.desc;
      document.getElementById('tempMax').textContent = `${tMax}Â°C`;
      document.getElementById('tempMin').textContent = `${tMin}Â°C`;
      document.getElementById('precip').textContent = `${precip}%`;
      document.getElementById('wind').textContent = `${windspeed}m/s`;

      // éŸ³å£°ãƒ†ã‚­ã‚¹ãƒˆ
      const dateStr = `${today.getMonth()+1}æœˆ${today.getDate()}æ—¥`;
      currentSpeechText = `${dateStr}ã®åŠ æ›½åˆ©ç”ºã®ãŠå¤©æ°—ã§ã™ã€‚ãã‚‡ã†ã¯${info.label}ã§ã—ã‚‡ã†ã€‚${info.desc} æœ€é«˜æ°—æ¸©ã¯${tMax}åº¦ã€æœ€ä½æ°—æ¸©ã¯${tMin}åº¦ã§ã™ã€‚é™æ°´ç¢ºç‡ã¯${precip}ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆã€‚é¢¨é€Ÿã¯æœ€å¤§${windspeed}ãƒ¡ãƒ¼ãƒˆãƒ«æ¯ç§’ã§ã™ã€‚`;

      loading.style.display = 'none';
      content.style.display = 'block';
      speakBtn.style.display = 'inline-block';
      btn.textContent = 'ğŸ”„ æ›´æ–°ã™ã‚‹';
      btn.disabled = false;

      // è‡ªå‹•èª­ã¿ä¸Šã’
      speakWeather();

    } catch(e) {
      loading.style.display = 'none';
      errorMsg.textContent = 'âš ï¸ å¤©æ°—ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚';
      errorMsg.style.display = 'block';
      btn.disabled = false;
    }
  }

  // èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ™‚åˆ»ã§èª¿æ•´
  (function() {
    const h = new Date().getHours();
    let bg;
    if (h < 6)       bg = 'linear-gradient(170deg,#1a1a4e 0%,#2d2d8a 50%,#1a3a6e 100%)';
    else if (h < 9)  bg = 'linear-gradient(170deg,#ffe0a0 0%,#ffb347 40%,#ff8c42 75%,#e8663a 100%)';
    else if (h < 17) bg = 'linear-gradient(170deg,#87ceeb 0%,#5bb8f5 40%,#2196f3 100%)';
    else if (h < 19) bg = 'linear-gradient(170deg,#ffe0a0 0%,#ffb347 40%,#ff8c42 75%,#e8663a 100%)';
    else             bg = 'linear-gradient(170deg,#1a1a4e 0%,#2d2d8a 50%,#1a3a6e 100%)';
    document.body.style.background = bg;
  })();
</script>
</body>
</html>
